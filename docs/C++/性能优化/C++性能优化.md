# C++性能优化

## 影响程序性能的各方面

1. 访问内存的开销, 从主存读取一个数据字的时间内可以执行数百条指令
2. 内存访问并非以字节为单位, c++认为每个字节都可以独立访问, 但计算机会通更大块的数据来补偿缓慢的内存速度
3. 某些内存访问会比其他的更慢, cpu高速缓存快于其他内存, 紧凑的循环可能会更快
4. 内存字分为大端和小端
5. 内存容量是有限的, 没有放入物理内存中的数据作为文件存储在磁盘上, 这种机制称为虚拟内存。
    - 函数运行于整个程序的上下文中时的执行速度可能是运行于测试套件中时的万分之一。当运行于整个程序的上下文中时，函数和它的数据不太可能存储至缓存中，而在测试套件的上下文中，它们则通常会被缓存起来
    - 如果一个大程序访问许多离散的内存地址，那么可能没有足够的高速缓存来保存程序刚刚使用的数据。这会导致一种性能衰退，称为页抖动(page thrashing)。当在微处理器内部的高速缓存中发生页抖动时, 性能会降低; 当在操作系统的虚拟缓存文件中发生页抖动时, 性能会下降为原来的 $1/1000$
6. 分支预测对程序影响很大
7. 上下文切换代价很大
8. 系统调用是昂贵的
